
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
	<title>YUI Library Examples: Attribute: Attribute Event Based Speed Dating</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    	<link rel="stylesheet" type="text/css" href="../../assets/yui.css" >

<style>
    /*Supplemental CSS for the YUI distribution*/
    #custom-doc { width: 95%; min-width: 950px; }
    #pagetitle {background-image: url(../../assets/bg_hd.gif);}
/*    #pagetitle h1 {background-image: url(../../assets/title_h_bg.gif);}*/
</style>

<link rel="stylesheet" type="text/css" href="../../assets/dpSyntaxHighlighter.css">
<link type="text/css" rel="stylesheet" href="../../build/cssfonts/fonts-min.css" />
<script type="text/javascript" src="../../build/yui/yui-min.js"></script>
<style type="text/css">
    #speeddate h1 {
        font-size: 108%;
        color:#000;
        margin-bottom:2em;
    }
    
    #john {
        margin-bottom:10px;
    }

    .interests.disabled, .reconsider.disabled {
        color:#888;
    }
    
    #john .interest {
        margin-left:5px;
    }

    .sd-nametag {
        border:1px solid #000;
        text-align:center;
        width:25em;
        margin:20px;
        
        background-color:#00f;

        border-radius: 10px;
        -webkit-border-radius: 10px;
        -moz-border-radius: 10px;
                
        box-shadow: 3px 3px 3px #888;
        -moz-box-shadow: 3px 3px 3px #888;
        -webkit-box-shadow: 3px 3px 3px #888;
    }

    .sd-nametag .sd-hd, 
    .sd-nametag .sd-ft {
        padding:5px;
        text-align:center;
        font-size:108%;
        font-weight:900;
        color:#fff;
    }

    .sd-nametag .sd-hd {    
        border-top-right-radius: 10px;
        border-top-left-radius: 10px;
        -moz-border-radius-topright: 10px;
        -moz-border-radius-topleft: 10px;
        -webkit-border-top-right-radius: 10px;
        -webkit-border-top-left-radius: 10px;
    }

    .sd-nametag .sd-ft {    
        border-bottom-right-radius: 10px;
        border-bottom-left-radius: 10px;
        -moz-border-radius-bottomright: 10px;
        -moz-border-radius-bottomleft: 10px;
        -webkit-border-bottom-right-radius: 10px;
        -webkit-border-bottom-left-radius: 10px;
    }

    .sd-nametag .sd-bd {
        background-color:#fff;
        padding:0.5em;
    }

    .sd-nametag .sd-bd .sd-name, 
    .sd-nametag .sd-bd .sd-personality, 
    .sd-nametag .sd-bd .sd-interests {
        font-size:108%;
        font-weight:900;
        font-family:monospace;
        text-decoration:underline;
        color:#00a;
    }
</style>
</head>
<body id="yahoo-com" class="yui3-skin-sam  yui-skin-sam">
<div id="custom-doc" class="yui-t2">
<div id="hd">
	<div id="ygunav">
		<p>
            <em>
                <a href="http://developer.yahoo.com/yui/3/">YUI 3.x Home</a> <i> - </i>	
            </em>
		</p>
		<form action="http://search.yahoo.com/search" id="sitesearchform">
            <input name="vs" type="hidden" value="developer.yahoo.com">
            <input name="vs" type="hidden" value="yuiblog.com">
		    <div id="sitesearch">
		    	<label for="searchinput">Site Search (YDN &amp; YUIBlog): </label>
			    <input type="text" id="searchinput" name="p">
			    <input type="submit" value="Search" id="searchsubmit" class="ygbt">
		    </div>
		</form>
    </div>
	<div id="ygma"><a href="../../"><img src="../../assets/logo.gif"  border="0" width="200" height="93"></a></div>
	<div id="pagetitle"><h1>YUI Library Examples: Attribute: Attribute Event Based Speed Dating</h1></div>
</div>
<div id="bd">


	<div id="yui-main">
		<div class="yui-b">
		  <div class="yui-ge">
			  <div class="yui-u first example" id="main">

	<h2>Attribute: Attribute Event Based Speed Dating</h2>

	<div id="example" class="promo">
	<div class="example-intro">
	<p>Attribute change events are one of the key benefits of using attributes to maintain state for your objects, instead of regular object properties.</p>

<p>This example refactors the basic <a href="attribute-basic-speeddate.html">"Attribute Based Speed Dating" example</a> to shows how you can listen for attribute change events to tie together your object's internal logic (such as updating the visual presentation of the object), and also to communicate with other objects.</p> 
	</div>	

	<div class="module example-container ">
			<div class="hd exampleHd">
			<p class="newWindowButton yui-skin-sam">
                <a href="attribute-event-speeddate_clean.html" target="_blank">View example in new window.</a>
            </p>
		</div>		<div id="example-canvas" class="bd">

		
	<!--BEGIN SOURCE CODE FOR EXAMPLE =============================== -->
	
	<div id="speeddate">

    <h1>Communicating With Attribute Events On Speed Dates</h1>

    <div id="john">
        <button type="button" class="hi">Hi, I'm John</button>

        <span class="interests disabled">
            I enjoy: 
            <label><input type="checkbox" class="interest" value="Sunsets" disabled="disabled"> Sunsets</label>
            <label><input type="checkbox" class="interest" value="Reading Specifications" disabled="disabled"> Reading Specifications</label> 
            <label><input type="checkbox" class="interest" value="Saving Whales" disabled="disabled"> Saving Whales</label>
            <label><input type="checkbox" class="interest" value="Knitting" disabled="disabled"> Knitting</label>
        </span>
        <div class="shirt"></div>
    </div>

    <div id="jane">
        <button type="button" class="hi" disabled="disabled">Hey, I'm Jane</button>
        <button type="button" class="movingOn" disabled="disabled">I'm Moving On...</button> <span class="reconsider disabled">(unless he likes whales, and avoids knitting <em class="message"></em>)</span>
        <div class="shirt"></div>
    </div>
</div>

<script type="text/javascript">

// Get a new instance of YUI and 
// load it with the required set of modules

YUI().use("collection", "event", "node", "attribute", "substitute", function(Y) {

    // Setup custom class which we want to add managed attribute support to

    function SpeedDater(cfg) {
        // When constructed, setup the initial attributes for the instance, by calling the addAttrs method.
        var attrs = {
            name : {
                writeOnce:true
            },

            personality : {
                value:50
            },

            available : {
                value:true
            }, 

            interests : {
                value : []
            }
        };

        this.addAttrs(attrs, cfg);
    }

    // The HTML template representing the SpeedDater name tag.
    SpeedDater.NAMETAG = '<div class="sd-nametag"> \
                            <div class="sd-hd">Hello!</div> \
                            <div class="sd-bd"> \
                                <p>I\'m <span class="sd-name">{name}</span> and my PersonalityQuotientIndex is <span class="sd-personality">{personality}</span></p> \
                                <p>I enjoy <span class="sd-interests">{interests}</span>.</p> \
                            </div> \
                            <div class="sd-ft sd-availability">{available}</div> \
                         </div>';

    // Method used to render the visual representation of a SpeedDater object's state (in this case as a name tag)
    SpeedDater.prototype.applyNameTag = function(where) {

        var tokens = {
            name: this.get("name"),
            available: (this.get("available")) ? "" : "Sorry, moving on",
            personality: this.get("personality"),
            interests: (this.get("interests").length == 0) ? "absolutely nothing" : this.get("interests").join(", ")
        };

        this.nameTag = Y.Node.create(Y.substitute(SpeedDater.NAMETAG, tokens));
        Y.one(where).appendChild(this.nameTag);

        this.listenForChanges();
    };

    // Method used to attach attribute change event listeners, so that the SpeedDater instance 
    // will react to changes in attribute state, and update what's rendered on the page
    SpeedDater.prototype.listenForChanges = function() {

        // Sync up the UI for "available", after the value of the "available" attribute has changed:
        this.after("availableChange", function(e) {
            var taken = (e.newVal) ? "" : "Oh, is that the time?";
            this.nameTag.one(".sd-availability").set("innerHTML", taken);
        });

        // Sync up the UI for "name", after the value of the "name" attribute has changed:
        this.after("nameChange", function(e) {
            var name = e.newVal;
            this.nameTag.one(".sd-name").set("innerHTML", name);
        });

        // Sync up the UI for "personality", after the value of the "personality" attribute has changed:
        this.after("personalityChange", function(e) {
            var personality = e.newVal;

            var personalityEl = this.nameTag.one(".sd-personality");
            personalityEl.set("innerHTML", personality);

            if (personality > 90) {
                personalityEl.addClass("sd-max");
            }
        });

        // Sync up the UI for "interests", after the value of the "interests" attribute has changed:
        this.after("interestsChange", function(e) {
            var interests = (e.newVal.length == 0) ? "absolutely nothing" : this.get("interests").join(", ");
            this.nameTag.one(".sd-interests").set("innerHTML", interests);
        });
    };

    // Augment custom class with Attribute
    Y.augment(SpeedDater, Y.Attribute);

    var john, jane;

    Y.on("click", function() {

        if (!john) {

            john = new SpeedDater({
                name: "John",
                personality: 78
            });
            john.applyNameTag("#john .shirt");

            Y.one("#jane .hi").set("disabled", false); 
        }

    }, "#john .hi");

    Y.on("click", function() {

        if (!jane) {

            jane = new SpeedDater({
                name: "Jane",
                personality: 82,
                interests: ["Popcorn", "Saving Whales"]
            });
            jane.applyNameTag("#jane .shirt");

            // Update Jane's interests state, after John's interests state changes...
            john.after("interestsChange", function(e) {

                var janesInterests = jane.get("interests"),
                    johnsInterests = e.newVal,

                    readingSpecs = "Reading Specifications";
    
                // If it turns out that John enjoys reading specs, then Jane can admit it too...
                if (Y.Array.indexOf(johnsInterests, readingSpecs) !== -1) {
                    if(Y.Array.indexOf(janesInterests, readingSpecs) == -1) {
                        janesInterests.push(readingSpecs);
                    }
                } else {
                    janesInterests = Y.Array.reject(janesInterests, function(item){return (item == readingSpecs);});
                }

                jane.set("interests", janesInterests);
                jane.set("available", true);

                setMessage("");
            });

            // We can also listen before an attribute changes its value, and decide if we want to
            // allow the state change to occur or not. Invoking e.preventDefault() stops the state from
            // being updated. 

            // In this case, Jane can change her mind about making herself unavailable, if John likes 
            // saving whales, as long as he doesn't dig knitting too.
 
            jane.on("availableChange", function(e) {
                var johnsInterests = john.get("interests");
                var janeAvailable = e.newVal;
                if (janeAvailable === false && Y.Array.indexOf(johnsInterests, "Saving Whales") !== -1 &&  Y.Array.indexOf(johnsInterests, "Knitting") == -1 ) {
                    // Reconsider..
                    e.preventDefault();

                    setMessage("... which he does");
                };
            });

            enableExampleUI();
        }

    }, "#jane .hi");

    Y.on("click", function() { 
        jane.set("available", false); 
    }, "#jane .movingOn");

    // A delegate DOM event listener which will update John's interests, based on the checkbox state, whenever
    // a checkbox is clicked.
    Y.delegate("click", function() {
        var interests = [];

        Y.Node.all("#john input[type=checkbox].interest").each(function(checkbox) {
            if (checkbox.get("checked")) {
                interests.push(checkbox.get("value"));
            }
        });
        john.set("interests", interests);

    }, "#john", "input[type=checkbox].interest");


    // Example helpers...
    function enableExampleUI() {
        Y.all("#jane button").set("disabled", false);
        Y.all("#john button").set("disabled", false);
        Y.all("#john input").set("disabled", false);
        Y.one("#john .interests").removeClass("disabled");
        Y.one("#jane .reconsider").removeClass("disabled");
    }
    
    function setMessage(msg) {
        Y.one("#jane .message").set("innerHTML", msg);      
    }

 });
</script>
	
	<!--END SOURCE CODE FOR EXAMPLE =============================== -->
	
		
		</div>
	</div>			
	</div>
		
	<h3>Listening For Attribute Change Events</h3>

<p>In this example, we'll look at how you can setup listeners for attribute change events, and work with the event payload which the listeners receive, 
using the <code>SpeedDater</code> class, introduced in the <a href="attribute-basic-speeddate.html">"Attribute Based Speed Dating" example</a>.</p>
 
<p>We'll create two SpeedDater instances, <code>jane</code> and <code>john</code>, and use the attribute events they generate both internally (within the class code), to wire up UI refreshes, 
and externally, to have <code>jane</code> react to changes in the <code>john</code>'s state.</p>

<h4>Setting Up The SpeedDater Class With Attribute</h4>

<p>We start by setting up the same basic class we created for the <a href="attribute-basic-speeddate.html">"Attribute Based Speed Dating" example</a>, with an additional attribute, <code>interests</code>, using the code below:</p>

<div id="syntax-7bef316a1d6b5c0124cb777c1b3dafb5" class="yui-syntax-highlight"><div class="numbers"><pre class="javascript" style="font-family:monospace;"><ol><li class="li1"><div class="de1"><span class="co1">// Setup custom class which we want to add managed attribute support to</span></div></li><li class="li1"><div class="de1"><span class="kw2">function</span> SpeedDater<span class="br0">&#40;</span>cfg<span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">    <span class="co1">// When constructed, setup the initial attributes for the instance, </span></div></li><li class="li1"><div class="de1">    <span class="co1">// by calling the addAttrs method.</span></div></li><li class="li2"><div class="de2">    <span class="kw2">var</span> attrs <span class="sy0">=</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">        <span class="kw3">name</span> <span class="sy0">:</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">            writeOnce<span class="sy0">:</span><span class="kw2">true</span></div></li><li class="li1"><div class="de1">        <span class="br0">&#125;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li2"><div class="de2">        personality <span class="sy0">:</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">            value<span class="sy0">:</span><span class="nu0">50</span></div></li><li class="li1"><div class="de1">        <span class="br0">&#125;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        available <span class="sy0">:</span> <span class="br0">&#123;</span></div></li><li class="li2"><div class="de2">            value<span class="sy0">:</span><span class="kw2">true</span></div></li><li class="li1"><div class="de1">        <span class="br0">&#125;</span><span class="sy0">,</span> </div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        interests <span class="sy0">:</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">            value <span class="sy0">:</span> <span class="br0">&#91;</span><span class="br0">&#93;</span></div></li><li class="li2"><div class="de2">        <span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">    <span class="br0">&#125;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    <span class="kw1">this</span>.<span class="me1">addAttrs</span><span class="br0">&#40;</span>attrs<span class="sy0">,</span> cfg<span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1"><span class="br0">&#125;</span></div></li><li class="li2"><div class="de2">&nbsp;</div></li><li class="li1"><div class="de1"><span class="co1">// Augment custom class with Attribute</span></div></li><li class="li1"><div class="de1">Y.<span class="me1">augment</span><span class="br0">&#40;</span>SpeedDater<span class="sy0">,</span> Y.<span class="me1">Attribute</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li></ol></pre></div><div class="nonumbers"><pre class="javascript" style="font-family:monospace;"><span class="co1">// Setup custom class which we want to add managed attribute support to</span>
<span class="kw2">function</span> SpeedDater<span class="br0">&#40;</span>cfg<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="co1">// When constructed, setup the initial attributes for the instance, </span>
    <span class="co1">// by calling the addAttrs method.</span>
    <span class="kw2">var</span> attrs <span class="sy0">=</span> <span class="br0">&#123;</span>
        <span class="kw3">name</span> <span class="sy0">:</span> <span class="br0">&#123;</span>
            writeOnce<span class="sy0">:</span><span class="kw2">true</span>
        <span class="br0">&#125;</span><span class="sy0">,</span>
&nbsp;
        personality <span class="sy0">:</span> <span class="br0">&#123;</span>
            value<span class="sy0">:</span><span class="nu0">50</span>
        <span class="br0">&#125;</span><span class="sy0">,</span>
&nbsp;
        available <span class="sy0">:</span> <span class="br0">&#123;</span>
            value<span class="sy0">:</span><span class="kw2">true</span>
        <span class="br0">&#125;</span><span class="sy0">,</span> 
&nbsp;
        interests <span class="sy0">:</span> <span class="br0">&#123;</span>
            value <span class="sy0">:</span> <span class="br0">&#91;</span><span class="br0">&#93;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">this</span>.<span class="me1">addAttrs</span><span class="br0">&#40;</span>attrs<span class="sy0">,</span> cfg<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="co1">// Augment custom class with Attribute</span>
Y.<span class="me1">augment</span><span class="br0">&#40;</span>SpeedDater<span class="sy0">,</span> Y.<span class="me1">Attribute</span><span class="br0">&#41;</span><span class="sy0">;</span></pre></div><textarea id="syntax-7bef316a1d6b5c0124cb777c1b3dafb5-plain">// Setup custom class which we want to add managed attribute support to
function SpeedDater(cfg) {
    // When constructed, setup the initial attributes for the instance, 
    // by calling the addAttrs method.
    var attrs = {
        name : {
            writeOnce:true
        },
 
        personality : {
            value:50
        },

        available : {
            value:true
        }, 
        
        interests : {
            value : []
        }
    };

    this.addAttrs(attrs, cfg);
}

// Augment custom class with Attribute
Y.augment(SpeedDater, Y.Attribute);</textarea></div>
<p>We then create two instances of SpeedDaters, <code>jane</code> and <code>john</code>:</p>

<div id="syntax-67f782f93897103283d4b38ff9b6fb09" class="yui-syntax-highlight"><div class="numbers"><pre class="javascript" style="font-family:monospace;"><ol><li class="li1"><div class="de1"><span class="co1">// Create a john instance...</span></div></li><li class="li1"><div class="de1">john <span class="sy0">=</span> <span class="kw2">new</span> SpeedDater<span class="br0">&#40;</span><span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">    <span class="kw3">name</span><span class="sy0">:</span> <span class="st0">&quot;John&quot;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">    personality<span class="sy0">:</span> <span class="nu0">78</span></div></li><li class="li2"><div class="de2"><span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1"><span class="co1">// ... and render to the page</span></div></li><li class="li1"><div class="de1">john.<span class="me1">applyNameTag</span><span class="br0">&#40;</span><span class="st0">&quot;#john .shirt&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="co1">// Create a jane instance...</span></div></li><li class="li2"><div class="de2">jane <span class="sy0">=</span> <span class="kw2">new</span> SpeedDater<span class="br0">&#40;</span><span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">    <span class="kw3">name</span><span class="sy0">:</span> <span class="st0">&quot;Jane&quot;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">    personality<span class="sy0">:</span> <span class="nu0">82</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">    interests<span class="sy0">:</span> <span class="br0">&#91;</span><span class="st0">&quot;Popcorn&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Saving Whales&quot;</span><span class="br0">&#93;</span></div></li><li class="li1"><div class="de1"><span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li2"><div class="de2">jane.<span class="me1">applyNameTag</span><span class="br0">&#40;</span><span class="st0">&quot;#jane .shirt&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li></ol></pre></div><div class="nonumbers"><pre class="javascript" style="font-family:monospace;"><span class="co1">// Create a john instance...</span>
john <span class="sy0">=</span> <span class="kw2">new</span> SpeedDater<span class="br0">&#40;</span><span class="br0">&#123;</span>
    <span class="kw3">name</span><span class="sy0">:</span> <span class="st0">&quot;John&quot;</span><span class="sy0">,</span>
    personality<span class="sy0">:</span> <span class="nu0">78</span>
<span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="co1">// ... and render to the page</span>
john.<span class="me1">applyNameTag</span><span class="br0">&#40;</span><span class="st0">&quot;#john .shirt&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// Create a jane instance...</span>
jane <span class="sy0">=</span> <span class="kw2">new</span> SpeedDater<span class="br0">&#40;</span><span class="br0">&#123;</span>
    <span class="kw3">name</span><span class="sy0">:</span> <span class="st0">&quot;Jane&quot;</span><span class="sy0">,</span>
    personality<span class="sy0">:</span> <span class="nu0">82</span><span class="sy0">,</span>
    interests<span class="sy0">:</span> <span class="br0">&#91;</span><span class="st0">&quot;Popcorn&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Saving Whales&quot;</span><span class="br0">&#93;</span>
<span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
jane.<span class="me1">applyNameTag</span><span class="br0">&#40;</span><span class="st0">&quot;#jane .shirt&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre></div><textarea id="syntax-67f782f93897103283d4b38ff9b6fb09-plain">// Create a john instance...
john = new SpeedDater({
    name: "John",
    personality: 78
});
// ... and render to the page
john.applyNameTag("#john .shirt");

// Create a jane instance...
jane = new SpeedDater({
    name: "Jane",
    personality: 82,
    interests: ["Popcorn", "Saving Whales"]
});
jane.applyNameTag("#jane .shirt");</textarea></div>
<h4>Registering Event Listeners</h4>

<p>For this event based example, we no longer have an <code>updateNameTag()</code> method which the user is responsible for calling when they want to refresh the name tag rendered on the page, as we did in the basic example. 
Instead the <code>SpeedDater</code> class sets up some internal attribute change event listeners in its <code>listenForChanges()</code> method, which will refresh the UI for a particular attribute, each time its value is modified:</p>

<div id="syntax-9a0e8e549fdc2f4c9bd74ade2495cccf" class="yui-syntax-highlight"><div class="numbers"><pre class="javascript" style="font-family:monospace;"><ol><li class="li1"><div class="de1"><span class="co1">// Method used to attach attribute change event listeners, so that </span></div></li><li class="li1"><div class="de1"><span class="co1">// the SpeedDater instance will react to changes in attribute state, </span></div></li><li class="li1"><div class="de1"><span class="co1">// and update what's rendered on the page</span></div></li><li class="li1"><div class="de1">SpeedDater.<span class="me1">prototype</span>.<span class="me1">listenForChanges</span> <span class="sy0">=</span> <span class="kw2">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li2"><div class="de2">&nbsp;</div></li><li class="li1"><div class="de1">    <span class="co1">// Sync up the UI for &quot;available&quot;, after the value of the &quot;available&quot; </span></div></li><li class="li1"><div class="de1">    <span class="co1">// attribute has changed:</span></div></li><li class="li1"><div class="de1">    <span class="kw1">this</span>.<span class="me1">after</span><span class="br0">&#40;</span><span class="st0">&quot;availableChange&quot;</span><span class="sy0">,</span> <span class="kw2">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">        <span class="kw2">var</span> taken <span class="sy0">=</span> <span class="br0">&#40;</span>e.<span class="me1">newVal</span><span class="br0">&#41;</span> <span class="sy0">?</span> <span class="st0">&quot;&quot;</span> <span class="sy0">:</span> <span class="st0">&quot;Oh, is that the time?&quot;</span><span class="sy0">;</span></div></li><li class="li2"><div class="de2">        <span class="kw1">this</span>.<span class="me1">nameTag</span>.<span class="me1">one</span><span class="br0">&#40;</span><span class="st0">&quot;.sd-availability&quot;</span><span class="br0">&#41;</span>.<span class="me1">set</span><span class="br0">&#40;</span><span class="st0">&quot;innerHTML&quot;</span><span class="sy0">,</span> taken<span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">    <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    <span class="co1">// Sync up the UI for &quot;name&quot;, after the value of the &quot;name&quot; </span></div></li><li class="li1"><div class="de1">    <span class="co1">// attribute has changed:</span></div></li><li class="li2"><div class="de2">    <span class="kw1">this</span>.<span class="me1">after</span><span class="br0">&#40;</span><span class="st0">&quot;nameChange&quot;</span><span class="sy0">,</span> <span class="kw2">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">        <span class="kw2">var</span> <span class="kw3">name</span> <span class="sy0">=</span> e.<span class="me1">newVal</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">        <span class="kw1">this</span>.<span class="me1">nameTag</span>.<span class="me1">one</span><span class="br0">&#40;</span><span class="st0">&quot;.sd-name&quot;</span><span class="br0">&#41;</span>.<span class="me1">set</span><span class="br0">&#40;</span><span class="st0">&quot;innerHTML&quot;</span><span class="sy0">,</span> <span class="kw3">name</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">    <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li2"><div class="de2">    <span class="co1">// Sync up the UI for &quot;personality&quot;, after the value of the &quot;personality&quot; </span></div></li><li class="li1"><div class="de1">    <span class="co1">// attribute has changed:</span></div></li><li class="li1"><div class="de1">    <span class="kw1">this</span>.<span class="me1">after</span><span class="br0">&#40;</span><span class="st0">&quot;personalityChange&quot;</span><span class="sy0">,</span> <span class="kw2">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">        <span class="kw2">var</span> personality <span class="sy0">=</span> e.<span class="me1">newVal</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li2"><div class="de2">        <span class="kw2">var</span> personalityEl <span class="sy0">=</span> <span class="kw1">this</span>.<span class="me1">nameTag</span>.<span class="me1">one</span><span class="br0">&#40;</span><span class="st0">&quot;.sd-personality&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">        personalityEl.<span class="me1">set</span><span class="br0">&#40;</span><span class="st0">&quot;innerHTML&quot;</span><span class="sy0">,</span> personality<span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        <span class="kw1">if</span> <span class="br0">&#40;</span>personality <span class="sy0">&gt;</span> <span class="nu0">90</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">            personalityEl.<span class="me1">addClass</span><span class="br0">&#40;</span><span class="st0">&quot;sd-max&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li2"><div class="de2">        <span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">    <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    <span class="co1">// Sync up the UI for &quot;interests&quot;, after the value of the &quot;interests&quot; </span></div></li><li class="li1"><div class="de1">    <span class="co1">// attribute has changed:</span></div></li><li class="li2"><div class="de2">    <span class="kw1">this</span>.<span class="me1">after</span><span class="br0">&#40;</span><span class="st0">&quot;interestsChange&quot;</span><span class="sy0">,</span> <span class="kw2">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">        <span class="kw2">var</span> interests <span class="sy0">=</span> <span class="br0">&#40;</span>e.<span class="me1">newVal</span>.<span class="me1">length</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="sy0">?</span> </div></li><li class="li1"><div class="de1">                    <span class="st0">&quot;absolutely nothing&quot;</span> <span class="sy0">:</span> <span class="kw1">this</span>.<span class="me1">get</span><span class="br0">&#40;</span><span class="st0">&quot;interests&quot;</span><span class="br0">&#41;</span>.<span class="me1">join</span><span class="br0">&#40;</span><span class="st0">&quot;, &quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">        <span class="kw1">this</span>.<span class="me1">nameTag</span>.<span class="me1">one</span><span class="br0">&#40;</span><span class="st0">&quot;.sd-interests&quot;</span><span class="br0">&#41;</span>.<span class="me1">set</span><span class="br0">&#40;</span><span class="st0">&quot;innerHTML&quot;</span><span class="sy0">,</span> interests<span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">    <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li2"><div class="de2"><span class="br0">&#125;</span><span class="sy0">;</span></div></li></ol></pre></div><div class="nonumbers"><pre class="javascript" style="font-family:monospace;"><span class="co1">// Method used to attach attribute change event listeners, so that </span>
<span class="co1">// the SpeedDater instance will react to changes in attribute state, </span>
<span class="co1">// and update what's rendered on the page</span>
SpeedDater.<span class="me1">prototype</span>.<span class="me1">listenForChanges</span> <span class="sy0">=</span> <span class="kw2">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
&nbsp;
    <span class="co1">// Sync up the UI for &quot;available&quot;, after the value of the &quot;available&quot; </span>
    <span class="co1">// attribute has changed:</span>
    <span class="kw1">this</span>.<span class="me1">after</span><span class="br0">&#40;</span><span class="st0">&quot;availableChange&quot;</span><span class="sy0">,</span> <span class="kw2">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw2">var</span> taken <span class="sy0">=</span> <span class="br0">&#40;</span>e.<span class="me1">newVal</span><span class="br0">&#41;</span> <span class="sy0">?</span> <span class="st0">&quot;&quot;</span> <span class="sy0">:</span> <span class="st0">&quot;Oh, is that the time?&quot;</span><span class="sy0">;</span>
        <span class="kw1">this</span>.<span class="me1">nameTag</span>.<span class="me1">one</span><span class="br0">&#40;</span><span class="st0">&quot;.sd-availability&quot;</span><span class="br0">&#41;</span>.<span class="me1">set</span><span class="br0">&#40;</span><span class="st0">&quot;innerHTML&quot;</span><span class="sy0">,</span> taken<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="co1">// Sync up the UI for &quot;name&quot;, after the value of the &quot;name&quot; </span>
    <span class="co1">// attribute has changed:</span>
    <span class="kw1">this</span>.<span class="me1">after</span><span class="br0">&#40;</span><span class="st0">&quot;nameChange&quot;</span><span class="sy0">,</span> <span class="kw2">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw2">var</span> <span class="kw3">name</span> <span class="sy0">=</span> e.<span class="me1">newVal</span><span class="sy0">;</span>
        <span class="kw1">this</span>.<span class="me1">nameTag</span>.<span class="me1">one</span><span class="br0">&#40;</span><span class="st0">&quot;.sd-name&quot;</span><span class="br0">&#41;</span>.<span class="me1">set</span><span class="br0">&#40;</span><span class="st0">&quot;innerHTML&quot;</span><span class="sy0">,</span> <span class="kw3">name</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="co1">// Sync up the UI for &quot;personality&quot;, after the value of the &quot;personality&quot; </span>
    <span class="co1">// attribute has changed:</span>
    <span class="kw1">this</span>.<span class="me1">after</span><span class="br0">&#40;</span><span class="st0">&quot;personalityChange&quot;</span><span class="sy0">,</span> <span class="kw2">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw2">var</span> personality <span class="sy0">=</span> e.<span class="me1">newVal</span><span class="sy0">;</span>
&nbsp;
        <span class="kw2">var</span> personalityEl <span class="sy0">=</span> <span class="kw1">this</span>.<span class="me1">nameTag</span>.<span class="me1">one</span><span class="br0">&#40;</span><span class="st0">&quot;.sd-personality&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        personalityEl.<span class="me1">set</span><span class="br0">&#40;</span><span class="st0">&quot;innerHTML&quot;</span><span class="sy0">,</span> personality<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="kw1">if</span> <span class="br0">&#40;</span>personality <span class="sy0">&gt;</span> <span class="nu0">90</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            personalityEl.<span class="me1">addClass</span><span class="br0">&#40;</span><span class="st0">&quot;sd-max&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="co1">// Sync up the UI for &quot;interests&quot;, after the value of the &quot;interests&quot; </span>
    <span class="co1">// attribute has changed:</span>
    <span class="kw1">this</span>.<span class="me1">after</span><span class="br0">&#40;</span><span class="st0">&quot;interestsChange&quot;</span><span class="sy0">,</span> <span class="kw2">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw2">var</span> interests <span class="sy0">=</span> <span class="br0">&#40;</span>e.<span class="me1">newVal</span>.<span class="me1">length</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="sy0">?</span> 
                    <span class="st0">&quot;absolutely nothing&quot;</span> <span class="sy0">:</span> <span class="kw1">this</span>.<span class="me1">get</span><span class="br0">&#40;</span><span class="st0">&quot;interests&quot;</span><span class="br0">&#41;</span>.<span class="me1">join</span><span class="br0">&#40;</span><span class="st0">&quot;, &quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">this</span>.<span class="me1">nameTag</span>.<span class="me1">one</span><span class="br0">&#40;</span><span class="st0">&quot;.sd-interests&quot;</span><span class="br0">&#41;</span>.<span class="me1">set</span><span class="br0">&#40;</span><span class="st0">&quot;innerHTML&quot;</span><span class="sy0">,</span> interests<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span><span class="sy0">;</span></pre></div><textarea id="syntax-9a0e8e549fdc2f4c9bd74ade2495cccf-plain">// Method used to attach attribute change event listeners, so that 
// the SpeedDater instance will react to changes in attribute state, 
// and update what's rendered on the page
SpeedDater.prototype.listenForChanges = function() {

    // Sync up the UI for "available", after the value of the "available" 
    // attribute has changed:
    this.after("availableChange", function(e) {
        var taken = (e.newVal) ? "" : "Oh, is that the time?";
        this.nameTag.one(".sd-availability").set("innerHTML", taken);
    });

    // Sync up the UI for "name", after the value of the "name" 
    // attribute has changed:
    this.after("nameChange", function(e) {
        var name = e.newVal;
        this.nameTag.one(".sd-name").set("innerHTML", name);
    });

    // Sync up the UI for "personality", after the value of the "personality" 
    // attribute has changed:
    this.after("personalityChange", function(e) {
        var personality = e.newVal;

        var personalityEl = this.nameTag.one(".sd-personality");
        personalityEl.set("innerHTML", personality);

        if (personality > 90) {
            personalityEl.addClass("sd-max");
        }
    });

    // Sync up the UI for "interests", after the value of the "interests" 
    // attribute has changed:
    this.after("interestsChange", function(e) {
        var interests = (e.newVal.length == 0) ? 
                    "absolutely nothing" : this.get("interests").join(", ");
        this.nameTag.one(".sd-interests").set("innerHTML", interests);
    });
};</textarea></div>
<p>
As seen in the above code, the event type for attribute change events is created by concatenating the attribute name with <code>"Change"</code> (e.g. <code>"availableChange"</code>). Whenever an attribute value is changed through Attribute's <code>set()</code> method, both <em>"on"</em> and <em>"after"</em> subscribers are notified.
</p>
<p> 
In the code snippet above, all the subscribers are listening for the <em>"after"</em> moment using the <code>after()</code> subscription method, since they're only interested in being notified after the value has actually changed. 
However, as we'll see below, the example also shows you how to use an <em>"on"</em> listener, to prevent the attribute state change from occuring under certain conditions.
</p>

<h4>On vs. After</h4>

<p>A single attribute change event has two moments which can be subscribed to, depending on what the subscriber wants to do when notified.</p> 

<p><strong>on :</strong> Subscribers to the <em>"on"</em> moment, will be notified <em>before</em> any actual state change has occurred. This provides the opportunity to prevent the state change from occurring, 
using the <code>preventDefault()</code> method of the event facade object passed to the subscriber. If you use <code>get()</code> to retrieve the value of the attribute in an <em>"on"</em> subscriber, you will receive the current, unchanged value. 
However the event facade provides access to the value which the attribute is being set to, through it's <code>newVal</code> property.</p>

<p><strong>after :</strong> Subscribers to the <em>"after"</em> moment, will be notified <em>after</em> the attribute's state has been updated. 
This provides the opportunity to update state in other parts of your application, in response to a change in the attribute's state.</p>

<p>Based on the definition above, <code>after</code> listeners are not invoked if state change is prevented; for example, due to one of the <em>"on"</em> listeners calling <code>preventDefault()</code> on the event object passed to the subscriber.</p>

<h4>Having Jane React To John</h4>

<p>Aside from the internal listeners set up by the class, in this example <code>jane</code> also sets up two more subscribers. The first is a subscriber, which allows <code>jane</code> to "reconsider" changing the state of her <code>available</code> attribute, 
under certain conditions. Since she may want to prevent the <code>available</code> attribute from being modified in this case, we use Attribute's <code>on()</code> method to listen for the <em>"on"</em> moment, so that the default behavior can be prevented:</p>

<div id="syntax-e030ff1b2a0c14508421565bef58c976" class="yui-syntax-highlight"><div class="numbers"><pre class="javascript" style="font-family:monospace;"><ol><li class="li1"><div class="de1"><span class="co1">// We can also listen before an attribute changes its value, and </span></div></li><li class="li1"><div class="de1"><span class="co1">// decide if we want to allow the state change to occur or not. </span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1"><span class="co1">// Invoking e.preventDefault() stops the state from being updated. </span></div></li><li class="li2"><div class="de2">&nbsp;</div></li><li class="li1"><div class="de1"><span class="co1">// In this case, Jane can change her mind about making herself </span></div></li><li class="li1"><div class="de1"><span class="co1">// unavailable, if John likes saving whales, as long as he doesn't </span></div></li><li class="li1"><div class="de1"><span class="co1">// dig knitting too.</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li2"><div class="de2">jane.<span class="me1">on</span><span class="br0">&#40;</span><span class="st0">&quot;availableChange&quot;</span><span class="sy0">,</span> <span class="kw2">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">    <span class="kw2">var</span> johnsInterests <span class="sy0">=</span> john.<span class="me1">get</span><span class="br0">&#40;</span><span class="st0">&quot;interests&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">    <span class="kw2">var</span> janeAvailable <span class="sy0">=</span> e.<span class="me1">newVal</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    <span class="kw1">if</span> <span class="br0">&#40;</span>janeAvailable <span class="sy0">===</span> <span class="kw2">false</span> <span class="sy0">&amp;&amp;</span> Y.<span class="me1">Array</span>.<span class="me1">indexOf</span><span class="br0">&#40;</span>johnsInterests<span class="sy0">,</span> <span class="st0">&quot;Saving Whales&quot;</span><span class="br0">&#41;</span> <span class="sy0">!==</span> <span class="sy0">-</span><span class="nu0">1</span> </div></li><li class="li2"><div class="de2">            <span class="sy0">&amp;&amp;</span> Y.<span class="me1">Array</span>.<span class="me1">indexOf</span><span class="br0">&#40;</span>johnsInterests<span class="sy0">,</span> <span class="st0">&quot;Knitting&quot;</span><span class="br0">&#41;</span> <span class="sy0">==</span> <span class="sy0">-</span><span class="nu0">1</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">        <span class="co1">// Reconsider..</span></div></li><li class="li1"><div class="de1">        e.<span class="me1">preventDefault</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">    <span class="br0">&#125;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1"><span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li></ol></pre></div><div class="nonumbers"><pre class="javascript" style="font-family:monospace;"><span class="co1">// We can also listen before an attribute changes its value, and </span>
<span class="co1">// decide if we want to allow the state change to occur or not. </span>
&nbsp;
<span class="co1">// Invoking e.preventDefault() stops the state from being updated. </span>
&nbsp;
<span class="co1">// In this case, Jane can change her mind about making herself </span>
<span class="co1">// unavailable, if John likes saving whales, as long as he doesn't </span>
<span class="co1">// dig knitting too.</span>
&nbsp;
jane.<span class="me1">on</span><span class="br0">&#40;</span><span class="st0">&quot;availableChange&quot;</span><span class="sy0">,</span> <span class="kw2">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw2">var</span> johnsInterests <span class="sy0">=</span> john.<span class="me1">get</span><span class="br0">&#40;</span><span class="st0">&quot;interests&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw2">var</span> janeAvailable <span class="sy0">=</span> e.<span class="me1">newVal</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">if</span> <span class="br0">&#40;</span>janeAvailable <span class="sy0">===</span> <span class="kw2">false</span> <span class="sy0">&amp;&amp;</span> Y.<span class="me1">Array</span>.<span class="me1">indexOf</span><span class="br0">&#40;</span>johnsInterests<span class="sy0">,</span> <span class="st0">&quot;Saving Whales&quot;</span><span class="br0">&#41;</span> <span class="sy0">!==</span> <span class="sy0">-</span><span class="nu0">1</span> 
            <span class="sy0">&amp;&amp;</span> Y.<span class="me1">Array</span>.<span class="me1">indexOf</span><span class="br0">&#40;</span>johnsInterests<span class="sy0">,</span> <span class="st0">&quot;Knitting&quot;</span><span class="br0">&#41;</span> <span class="sy0">==</span> <span class="sy0">-</span><span class="nu0">1</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="co1">// Reconsider..</span>
        e.<span class="me1">preventDefault</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">;</span>
<span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre></div><textarea id="syntax-e030ff1b2a0c14508421565bef58c976-plain">// We can also listen before an attribute changes its value, and 
// decide if we want to allow the state change to occur or not. 

// Invoking e.preventDefault() stops the state from being updated. 

// In this case, Jane can change her mind about making herself 
// unavailable, if John likes saving whales, as long as he doesn't 
// dig knitting too.

jane.on("availableChange", function(e) {
    var johnsInterests = john.get("interests");
    var janeAvailable = e.newVal;

    if (janeAvailable === false && Y.Array.indexOf(johnsInterests, "Saving Whales") !== -1 
            && Y.Array.indexOf(johnsInterests, "Knitting") == -1 ) {
        // Reconsider..
        e.preventDefault();
    };
});</textarea></div>
<p>We also set up an <em>"after"</em> listener on the <code>john</code> instance, which allows <code>jane</code> to update her interests, so she can admit to enjoying "Reading Specifications", if <code>john</code> admits it first:</p>

<div id="syntax-8234c346850af4f0edfe93a283618be5" class="yui-syntax-highlight"><div class="numbers"><pre class="javascript" style="font-family:monospace;"><ol><li class="li1"><div class="de1"><span class="co1">// Consider updating Jane's interests state, after John's interests </span></div></li><li class="li1"><div class="de1"><span class="co1">// state changes...</span></div></li><li class="li1"><div class="de1">john.<span class="me1">after</span><span class="br0">&#40;</span><span class="st0">&quot;interestsChange&quot;</span><span class="sy0">,</span> <span class="kw2">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li2"><div class="de2">    <span class="kw2">var</span> janesInterests <span class="sy0">=</span> jane.<span class="me1">get</span><span class="br0">&#40;</span><span class="st0">&quot;interests&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">        <span class="co1">// Get john's new interests from the attribute change event...</span></div></li><li class="li1"><div class="de1">        johnsInterests <span class="sy0">=</span> e.<span class="me1">newVal</span><span class="sy0">,</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li2"><div class="de2">        readingSpecs <span class="sy0">=</span> <span class="st0">&quot;Reading Specifications&quot;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    <span class="co1">// If it turns out that John enjoys reading specs, then Jane can admit it too...</span></div></li><li class="li1"><div class="de1">    <span class="kw1">if</span> <span class="br0">&#40;</span>Y.<span class="me1">Array</span>.<span class="me1">indexOf</span><span class="br0">&#40;</span>johnsInterests<span class="sy0">,</span> readingSpecs<span class="br0">&#41;</span> <span class="sy0">!==</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">        <span class="kw1">if</span><span class="br0">&#40;</span>Y.<span class="me1">Array</span>.<span class="me1">indexOf</span><span class="br0">&#40;</span>janesInterests<span class="sy0">,</span> readingSpecs<span class="br0">&#41;</span> <span class="sy0">==</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="br0">&#123;</span></div></li><li class="li2"><div class="de2">            janesInterests.<span class="me1">push</span><span class="br0">&#40;</span>readingSpecs<span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">        <span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">    <span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span></div></li><li class="li1"><div class="de1">        <span class="co1">// Otherwise, we use Y.Array.reject, provided by the &quot;collection&quot; module, </span></div></li><li class="li1"><div class="de1">        <span class="co1">// to remove &quot;Reading Specifications&quot; from jane's interests..</span></div></li><li class="li2"><div class="de2">        janesInterests <span class="sy0">=</span> Y.<span class="me1">Array</span>.<span class="me1">reject</span><span class="br0">&#40;</span>janesInterests<span class="sy0">,</span> </div></li><li class="li1"><div class="de1">                            <span class="kw2">function</span><span class="br0">&#40;</span><span class="kw1">item</span><span class="br0">&#41;</span><span class="br0">&#123;</span><span class="kw1">return</span> <span class="br0">&#40;</span><span class="kw1">item</span> <span class="sy0">==</span> readingSpecs<span class="br0">&#41;</span><span class="sy0">;</span><span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">    <span class="br0">&#125;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    jane.<span class="me1">set</span><span class="br0">&#40;</span><span class="st0">&quot;interests&quot;</span><span class="sy0">,</span> janesInterests<span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li2"><div class="de2">    jane.<span class="me1">set</span><span class="br0">&#40;</span><span class="st0">&quot;available&quot;</span><span class="sy0">,</span> <span class="kw2">true</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1"><div class="de1">&nbsp;</div></li><li class="li1"><div class="de1">    ...</div></li><li class="li1"><div class="de1"><span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li></ol></pre></div><div class="nonumbers"><pre class="javascript" style="font-family:monospace;"><span class="co1">// Consider updating Jane's interests state, after John's interests </span>
<span class="co1">// state changes...</span>
john.<span class="me1">after</span><span class="br0">&#40;</span><span class="st0">&quot;interestsChange&quot;</span><span class="sy0">,</span> <span class="kw2">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span>
&nbsp;
    <span class="kw2">var</span> janesInterests <span class="sy0">=</span> jane.<span class="me1">get</span><span class="br0">&#40;</span><span class="st0">&quot;interests&quot;</span><span class="br0">&#41;</span><span class="sy0">,</span>
&nbsp;
        <span class="co1">// Get john's new interests from the attribute change event...</span>
        johnsInterests <span class="sy0">=</span> e.<span class="me1">newVal</span><span class="sy0">,</span>
&nbsp;
        readingSpecs <span class="sy0">=</span> <span class="st0">&quot;Reading Specifications&quot;</span><span class="sy0">;</span>
&nbsp;
    <span class="co1">// If it turns out that John enjoys reading specs, then Jane can admit it too...</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>Y.<span class="me1">Array</span>.<span class="me1">indexOf</span><span class="br0">&#40;</span>johnsInterests<span class="sy0">,</span> readingSpecs<span class="br0">&#41;</span> <span class="sy0">!==</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">if</span><span class="br0">&#40;</span>Y.<span class="me1">Array</span>.<span class="me1">indexOf</span><span class="br0">&#40;</span>janesInterests<span class="sy0">,</span> readingSpecs<span class="br0">&#41;</span> <span class="sy0">==</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            janesInterests.<span class="me1">push</span><span class="br0">&#40;</span>readingSpecs<span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span>
        <span class="co1">// Otherwise, we use Y.Array.reject, provided by the &quot;collection&quot; module, </span>
        <span class="co1">// to remove &quot;Reading Specifications&quot; from jane's interests..</span>
        janesInterests <span class="sy0">=</span> Y.<span class="me1">Array</span>.<span class="me1">reject</span><span class="br0">&#40;</span>janesInterests<span class="sy0">,</span> 
                            <span class="kw2">function</span><span class="br0">&#40;</span><span class="kw1">item</span><span class="br0">&#41;</span><span class="br0">&#123;</span><span class="kw1">return</span> <span class="br0">&#40;</span><span class="kw1">item</span> <span class="sy0">==</span> readingSpecs<span class="br0">&#41;</span><span class="sy0">;</span><span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    jane.<span class="me1">set</span><span class="br0">&#40;</span><span class="st0">&quot;interests&quot;</span><span class="sy0">,</span> janesInterests<span class="br0">&#41;</span><span class="sy0">;</span>
    jane.<span class="me1">set</span><span class="br0">&#40;</span><span class="st0">&quot;available&quot;</span><span class="sy0">,</span> <span class="kw2">true</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    ...
<span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre></div><textarea id="syntax-8234c346850af4f0edfe93a283618be5-plain">// Consider updating Jane's interests state, after John's interests 
// state changes...
john.after("interestsChange", function(e) {

    var janesInterests = jane.get("interests"),

        // Get john's new interests from the attribute change event...
        johnsInterests = e.newVal,

        readingSpecs = "Reading Specifications";

    // If it turns out that John enjoys reading specs, then Jane can admit it too...
    if (Y.Array.indexOf(johnsInterests, readingSpecs) !== -1) {
        if(Y.Array.indexOf(janesInterests, readingSpecs) == -1) {
            janesInterests.push(readingSpecs);
        }
    } else {
        // Otherwise, we use Y.Array.reject, provided by the "collection" module, 
        // to remove "Reading Specifications" from jane's interests..
        janesInterests = Y.Array.reject(janesInterests, 
                            function(item){return (item == readingSpecs);});
    }

    jane.set("interests", janesInterests);
    jane.set("available", true);

    ...
});</textarea></div>
<h4>Event Facade</h4>

<p>The event object (an instance of <a href="../../api/EventFacade.html">EventFacade</a>) passed to attribute change event subscribers, has the following interesting properties and methods related to attribute management:</p>

<dl>
    <dt>newVal</dt>
    <dd>The value which the attribute will be set to (in the case of <em>"on"</em> subscribers), or has been set to (in the case of <em>"after"</em> subscribers</dd>
    <dt>prevVal</dt>
    <dd>The value which the attribute is currently set to (in the case of <em>"on"</em> subscribers), or was previously set to (in the case of <em>"after"</em> subscribers</dd>
    <dt>attrName</dt>
    <dd>The name of the attribute which is being set</dd>
    <dt>subAttrName</dt>
    <dd>Attribute also allows you to set nested properties of attributes which have values which are objects through the 
    <code>set</code> method (e.g. <code>o1.set("x.y.z")</code>). This property will contain the path to the property which was changed.</dd>
    <dt>preventDefault()<dt>
    <dd>This method can be called in an <em>"on"</em> subscriber to prevent the attribute's value from being updated (the default behavior). Calling this method in an <em>"after"</em> listener has no impact, since the default behavior has already been invoked.</dd>
    <dt>stopImmediatePropagation()</dt>
    <dd>This method can be called in <em>"on"</em> or <em>"after"</em> subscribers, and will prevent the rest of the subscriber stack from
    being invoked, but will not prevent the attribute's value from being updated.</dd>
</dl>
				</div>
				<div class="yui-u sidebar">
					
				
					<div id="examples" class="mod box4">
                        <div class="hd">
						<h4>
    Attribute Examples:</h4>
                        </div>
						<div class="bd">
							<ul>
								<li><a href='../attribute/attribute-basic.html'>Basic Attribute Configuration</a></li><li><a href='../attribute/attribute-rw.html'>Read-Only and Write-Once Attributes</a></li><li><a href='../attribute/attribute-event.html'>Attribute Change Events</a></li><li><a href='../attribute/attribute-basic-speeddate.html'>Attribute Based Speed Dating</a></li><li class='selected'><a href='../attribute/attribute-event-speeddate.html'>Attribute Event Based Speed Dating</a></li><li><a href='../attribute/attribute-getset.html'>Attribute Getters, Setters and Validators</a></li>							</ul>
						</div>
					</div>
					
					<div class="mod box4">
                        <div class="hd">
						<h4>More Attribute Resources:</h4>
                        </div>
                        <div class="bd">
						<ul>
							<!-- <li><a href="http://developer.yahoo.com/yui/attribute/">User's Guide</a> (external)</li> -->
<li><a href="../../api/module_attribute.html">API Documentation</a></li></ul>
                        </div>
					</div>
			  </div>
		</div>
		
		</div>
	</div>


<div class="yui-b toc3" id="tocWrapper">
<!-- TABLE OF CONTENTS -->
<div id="toc">
	
<ul>
<li class="sect first">YUI 3 Resources</li><li class="item"><a title="YUI 3 -- Yahoo! User Interface (YUI) Library" href="http://developer.yahoo.com/yui/3/">YUI 3 Web Site</a></li><li class="item"><a title="Examples of every YUI utility and control in action" href="../../examples/">YUI 3 Examples</a></li><li class="item"><a title="Instantly searchable API documentation for the entire YUI library." href="../../api/">YUI 3 API Docs</a></li><li class="item"><a title="YUI 3 Dependency Configurator -- configure your custom YUI implementation" href="http://developer.yahoo.com/yui/3/configurator/index.html">YUI 3 Dependency Configurator</a></li><li class="item"><a title="The YUI 3 Forum on YUILibrary.com" href="http://yuilibrary.com/forum/viewforum.php?f=15">YUI 3 Forums (external)</a></li><li class="item"><a title="Found a bug or a missing feature? Let us know on YUILibrary.com." href="http://developer.yahoo.com/yui/articles/reportingbugs/">Bug Reports/Feature Requests</a></li><li class="item"><a title="YUI is free and open, offered under a BSD license." href="http://developer.yahoo.com/yui/license.html">YUI License</a></li><li class="item"><a title="Download and fork the YUI project on GitHub" href="http://github.com/yui">YUI on Github</a></li><li class="item"><a title="The Yahoo! User Interface Blog" href="http://yuiblog.com">YUI Blog (external)</a></li><li class="sect">YUI 3 Core - Examples</li><li class="item"><a title="YUI Global Object - Functional Examples" href="../../examples/yui/index.html">YUI Global Object</a></li><li class="item"><a title="Event - Functional Examples" href="../../examples/event/index.html">Event</a></li><li class="item"><a title="Node - Functional Examples" href="../../examples/node/index.html">Node</a></li><li class="sect">YUI 3 Component Infrastructure - Examples</li><li class="selected "><a title="Attribute - Functional Examples" href="../../examples/attribute/index.html">Attribute</a></li><li class="item"><a title="Plugin - Functional Examples" href="../../examples/plugin/index.html">Plugin</a></li><li class="item"><a title="Widget - Functional Examples" href="../../examples/widget/index.html">Widget</a></li><li class="sect">YUI 3 Utilities - Examples</li><li class="item"><a title="Animation - Functional Examples" href="../../examples/anim/index.html">Animation</a></li><li class="item"><a title="AsyncQueue - Functional Examples" href="../../examples/async-queue/index.html">AsyncQueue</a></li><li class="item"><a title="Cache - Functional Examples" href="../../examples/cache/index.html">Cache</a></li><li class="item"><a title="Cookie - Functional Examples" href="../../examples/cookie/index.html">Cookie</a></li><li class="item"><a title="DataSchema - Functional Examples" href="../../examples/dataschema/index.html">DataSchema <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="item"><a title="DataSource - Functional Examples" href="../../examples/datasource/index.html">DataSource <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="item"><a title="DataType - Functional Examples" href="../../examples/datatype/index.html">DataType <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="item"><a title="Drag &amp; Drop - Functional Examples" href="../../examples/dd/index.html">Drag &amp; Drop</a></li><li class="item"><a title="Editor - Functional Examples" href="../../examples/editor/index.html">Editor <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="item"><a title="Get - Functional Examples" href="../../examples/get/index.html">Get</a></li><li class="item"><a title="History - Functional Examples" href="../../examples/history/index.html">History <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="item"><a title="IO - Functional Examples" href="../../examples/io/index.html">IO</a></li><li class="item"><a title="ImageLoader - Functional Examples" href="../../examples/imageloader/index.html">ImageLoader</a></li><li class="item"><a title="Internationalization - Functional Examples" href="../../examples/intl/index.html">Internationalization <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="item"><a title="JSON (JavaScript Object Notation) - Functional Examples" href="../../examples/json/index.html">JSON</a></li><li class="item"><a title="JSONP (JSON with Padding) - Functional Examples" href="../../examples/jsonp/index.html">JSONP <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="item"><a title="Stylesheet - Functional Examples" href="../../examples/stylesheet/index.html">Stylesheet</a></li><li class="item"><a title="Sortable - Functional Examples" href="../../examples/sortable/index.html">Sortable <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="item"><a title="Transition - Functional Examples" href="../../examples/transition/index.html">Transition <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="item"><a title="Uploader - Functional Examples" href="../../examples/uploader/index.html">Uploader <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="item"><a title="YQL Query - Functional Examples" href="../../examples/yql/index.html">YQL Query <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="sect">YUI 3 Widgets - Examples</li><li class="item"><a title="Overlay - Functional Examples" href="../../examples/overlay/index.html">Overlay <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="item"><a title="ScrollView - Functional Examples" href="../../examples/scrollview/index.html">ScrollView <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="item"><a title="Slider - Functional Examples" href="../../examples/slider/index.html">Slider <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="item"><a title="Tabview - Functional Examples" href="../../examples/tabview/index.html">Tabview <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="sect">YUI 3 Node Plugins - Examples</li><li class="item"><a title="FocusManager Node Plugin - Functional Examples" href="../../examples/node-focusmanager/index.html">FocusManager Node Plugin <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="item"><a title="MenuNav Node Plugin - Functional Examples" href="../../examples/node-menunav/index.html">MenuNav Node Plugin <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="sect">YUI 3 CSS - Examples</li><li class="item"><a title="YUI Base - Functional Examples" href="../../examples/cssbase/index.html">CSS Base</a></li><li class="item"><a title="YUI Fonts - Functional Examples" href="../../examples/cssfonts/index.html">CSS Fonts</a></li><li class="item"><a title="YUI Grids - Functional Examples" href="../../examples/cssgrids/index.html">CSS Grids <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="item"><a title="YUI CSS Reset - Functional Examples" href="../../examples/cssreset/index.html">CSS Reset</a></li><li class="sect">YUI 3 Developer Tools - Examples</li><li class="item"><a title="Console - Functional Examples" href="../../examples/console/index.html">Console <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="item"><a title="Console Filters Plugin- Functional Examples" href="../../examples/console-filters/index.html">Plugin.ConsoleFilters <img alt='beta' src='http://l.yimg.com/a/i/not/beta_1.gif'></a></li><li class="item"><a title="Profiler - Functional Examples" href="../../examples/profiler/index.html">Profiler</a></li><li class="item"><a title="Test - Functional Examples" href="../../examples/test/index.html">Test</a></li><li class="sect">Other Useful YUI 3 Resources</li><li class="item"><a title="Answers to Frequently Asked Questions about the YUI Library" href="http://developer.yahoo.com/yui/articles/faq/">YUI FAQ (external)</a></li><li class="item"><a title="Yahoo!'s philosophy of Graded Browser Support" href="http://developer.yahoo.com/yui/articles/gbs/">Graded Browser Support (external)</a></li><li class="item"><a title="Videos and podcasts from the YUI Team and from the Yahoo! frontend engineering community." href="http://developer.yahoo.com/yui/theater/">YUI Theater (external)</a></li></ul>
</div>
</div>
	</div><!--closes bd-->

	<div id="ft">
        <p class="first">Copyright &copy; 2010 Yahoo! Inc. All rights reserved.</p>
        <p><a href="http://privacy.yahoo.com/privacy/us/devel/index.html">Privacy Policy</a> - 
            <a href="http://docs.yahoo.com/info/terms/">Terms of Service</a> - 
            <a href="http://docs.yahoo.com/info/copyright/copyright.html">Copyright Policy</a> - 
            <a href="http://careers.yahoo.com/">Job Openings</a></p>
	</div>
</div>
<script language="javascript"> 
var yuiConfig = {};
</script>
<script src="../../assets/syntax.js"></script>
<script src="../../assets/dpSyntaxHighlighter.js"></script>
<script language="javascript"> 
dp.SyntaxHighlighter.HighlightAll('code'); 
</script>
</body>
</html>
